name: dc2

topology:
  kinds:
    srl:
      image: ghcr.io/nokia/srlinux
    linux:
      image: ghcr.io/hellt/network-multitool
  nodes:
    node1:
      kind: srl
      type: ixrd2
      # leaf configurations, e.g: set / interface ethernet-1/49 subinterface 0 ipv4 address 192.168.11.1/30
      #startup-config: configs/leaf1.cfg
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    node2:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    node3:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    node4:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    node5:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    node6:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    server11:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:11 dev eth1
        - ip addr add 192.168.0.1/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server21:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:21 dev eth1
        - ip addr add 192.168.0.1/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server22:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:22 dev eth1
        - ip addr add 192.168.0.2/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server13:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:13 dev eth1
        - ip addr add 192.168.0.3/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server23:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:23 dev eth1
        - ip addr add 192.168.0.3/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
  links:
  # POD 1:
    # node1 <-> spines
    - endpoints: ["node1:e1-49", "node5:e1-1"]
    - endpoints: ["node1:e1-50", "node6:e1-1"]
    # node2 <-> spines
    - endpoints: ["node2:e1-49", "node5:e1-2"]
    - endpoints: ["node2:e1-50", "node6:e1-2"]
    # node3 <-> spines
    - endpoints: ["node3:e1-49", "node5:e1-3"]
    - endpoints: ["node3:e1-50", "node6:e1-3"]
    # node4 <-> spines
    - endpoints: ["node4:e1-49", "node5:e1-4"]
    - endpoints: ["node4:e1-50", "node6:e1-4"]
    # server links
    - endpoints: ["server11:eth1", "node1:e1-1"]
    - endpoints: ["server21:eth1", "node1:e1-2"]
    - endpoints: ["server22:eth1", "node2:e1-1"]
    - endpoints: ["server13:eth1", "node3:e1-1"]
    - endpoints: ["server23:eth1", "node3:e1-2"]
