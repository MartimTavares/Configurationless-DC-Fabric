name: dc1

topology:
  kinds:
    srl:
      image: ghcr.io/nokia/srlinux
    linux:
      image: ghcr.io/hellt/network-multitool
  nodes:
    leaf1:
      kind: srl
      type: ixrd2
      # leaf configurations, e.g: set / interface ethernet-1/49 subinterface 0 ipv4 address 192.168.11.1/30
      #startup-config: configs/leaf1.cfg
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    leaf2:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    leaf3:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    leaf4:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    leaf5:
      kind: srl
      type: ixrd2
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    spine1:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    spine2:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    spine3:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    border1:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    border2:
      kind: srl
      type: ixrd3
      binds:
        ## - Executable File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.sh:/usr/local/bin/configurationless.sh:rw
        ## - YANG Models:
        #- /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yang:/opt/configurationless/yang/configurationless.yang:rw
        ## - Configuration File:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.yml:/etc/opt/srlinux/appmgr/configurationless.yml:rw
        ## - Python Script:
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/configurationless.py:/etc/opt/srlinux/appmgr/user_agents/configurationless.py:rw
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/nodesRolesAlgorithm.py:/etc/opt/srlinux/appmgr/user_agents/algorithms/nodesRolesAlgorithm.py:rw
        ## - Input file to originate CA
        - /home/nokia/Desktop/martim/Configurationless-DC-Fabric/containerlab/clab-dc-1/clab-dc1/.tls/ca/ca.pem:/ca.pem:rw
      exec:
        - chmod +r /etc/opt/srlinux/appmgr/user_agents/
        - chmod +x /usr/local/bin/configurationless.sh
    server11:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:11 dev eth1
        - ip addr add 192.168.0.1/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server21:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:21 dev eth1
        - ip addr add 192.168.0.1/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server22:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:22 dev eth1
        - ip addr add 192.168.0.2/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server13:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:13 dev eth1
        - ip addr add 192.168.0.3/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
    server23:
      kind: linux
      exec:
        - ip link set address 00:c1:ab:11:00:23 dev eth1
        - ip addr add 192.168.0.3/24 dev eth1
        - sysctl -w net.ipv6.conf.all.disable_ipv6=1
  links:
  # inter-switch links
    # leaf1 <-> spines
    - endpoints: ["leaf1:e1-48", "spine1:e1-1"]
    - endpoints: ["leaf1:e1-49", "spine2:e1-1"]
    - endpoints: ["leaf1:e1-50", "spine3:e1-1"]
    # leaf2 <-> spines
    - endpoints: ["leaf2:e1-48", "spine1:e1-2"]
    - endpoints: ["leaf2:e1-49", "spine2:e1-2"]
    - endpoints: ["leaf2:e1-50", "spine3:e1-2"]
    # leaf3 <-> spines
    - endpoints: ["leaf3:e1-48", "spine1:e1-3"]
    - endpoints: ["leaf3:e1-49", "spine2:e1-3"]
    - endpoints: ["leaf3:e1-50", "spine3:e1-3"]
    # leaf4 <-> spines
    - endpoints: ["leaf4:e1-48", "spine1:e1-4"]
    - endpoints: ["leaf4:e1-49", "spine2:e1-4"]
    - endpoints: ["leaf4:e1-50", "spine3:e1-4"]
    # leaf5 <-> spines
    - endpoints: ["leaf5:e1-48", "spine1:e1-5"]
    - endpoints: ["leaf5:e1-49", "spine2:e1-5"]
    - endpoints: ["leaf5:e1-50", "spine3:e1-5"]
    # spine1 <-> borders
    - endpoints: ["spine1:e1-6", "border1:e1-1"]
    - endpoints: ["spine1:e1-7", "border2:e1-1"]
    # spine2 <-> borders
    - endpoints: ["spine2:e1-6", "border1:e1-2"]
    - endpoints: ["spine2:e1-7", "border2:e1-2"]
    # spine3 <-> borders
    - endpoints: ["spine3:e1-6", "border1:e1-3"]
    - endpoints: ["spine3:e1-7", "border2:e1-3"]
    # server links
    - endpoints: ["server11:eth1", "leaf1:e1-1"]
    - endpoints: ["server21:eth1", "leaf1:e1-2"]
    - endpoints: ["server22:eth1", "leaf2:e1-1"]
    - endpoints: ["server13:eth1", "leaf3:e1-1"]
    - endpoints: ["server23:eth1", "leaf3:e1-2"]
